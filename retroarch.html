<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>PS1 Web Emulator</title>
<style>
    body, html {
        margin: 0;
        padding: 0;
        width: 100%;
        height: 100%;
        overflow: hidden;
        background: black;
    }
    canvas {
        width: 100vw !important;
        height: 100vh !important;
    }
</style>
</head>

<body>
<script src="https://webretro.github.io/webretro/webretro.js"></script>

<script>
// -------------------------------
// CONFIGURAÇÕES
// -------------------------------

// ROM do usuário
const romURL = "https://github.com/johnny1201/emulator/releases/download/v1/Harvest.Moon.-.Back.to.Nature.bin";

// Mapeamento do PS1 para teclado
// Atende exatamente o que você pediu
const keymap = {
    "ArrowUp":       "UP",
    "ArrowDown":     "DOWN",
    "ArrowLeft":     "LEFT",
    "ArrowRight":    "RIGHT",

    "w": "UP",
    "a": "LEFT",
    "s": "DOWN",
    "d": "RIGHT",

    // Quadrado, X, Bolinha, Triângulo = J K L I
    "j": "SQUARE",
    "k": "CROSS",
    "l": "CIRCLE",
    "i": "TRIANGLE",

    // L1, L2 = Q e 2
    "q": "L1",
    "2": "L2",

    // R1, R2 = U e 8
    "u": "R1",
    "8": "R2",

    // Start = Enter
    "Enter": "START",

    // Select = Espaço
    " ": "SELECT"
};

// -------------------------------
// INICIALIZAÇÃO DO EMULADOR
// -------------------------------
window.onload = () => {
    WebRetro.load({
        core: "beetle-psx",
        rom: romURL,
        system: "psx",
        autoplay: true,
        gamepad: true,

        onload: function (instance) {
            console.log("Emulador carregado.");

            // Adiciona o mapeamento customizado de teclas
            document.addEventListener("keydown", (ev) => {
                const key = ev.key;
                if (keymap[key]) {
                    instance.sendInput(keymap[key], true);
                    ev.preventDefault();
                }
            });

            document.addEventListener("keyup", (ev) => {
                const key = ev.key;
                if (keymap[key]) {
                    instance.sendInput(keymap[key], false);
                    ev.preventDefault();
                }
            });
        }
    });
};
</script>

</body>
</html>
